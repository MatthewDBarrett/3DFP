---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';

const images = import.meta.glob('/src/assets/SampleRenders/*.{jpeg,jpg,png,gif,webp}');
---

<Layout title="3D Floor Plans | High-Fidelity Architectural Modeling">
    <nav class="fixed w-full z-50 top-0 bg-white/80 backdrop-blur-md border-b border-slate-200">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <span class="text-xl font-bold tracking-tighter text-slate-800">3DFLOORPLANS<span class="text-blue-600">.COM.AU</span></span>
            <div class="flex items-center space-x-8">
                <a href="#portfolio" class="text-sm font-medium text-slate-600">Portfolio</a>
                <a href="#services" class="text-sm font-medium text-slate-600">Services</a>
                <a href="#contact" class="bg-slate-900 text-white px-5 py-2 rounded-full text-sm font-medium">Get a Quote</a>
            </div>
        </div>
    </nav>

    <main class="pt-32">
        <section id="contact" class="max-w-4xl mx-auto px-6 mb-32 text-slate-900">
            <div class="bg-blue-600 rounded-[2rem] p-12 text-center text-white relative overflow-hidden">
                <div class="absolute top-0 right-0 -translate-y-1/2 translate-x-1/2 w-64 h-64 bg-white/10 rounded-full blur-3xl"></div>
                
                <div id="form-container">
                    <h2 class="text-4xl font-bold mb-4">Request a 3D Floor Plan</h2>
                    <p class="text-blue-100 mb-10 text-lg">Upload your 2D blueprints, and our team will get back to you within 24 hours.</p>

                    <form id="contact-form" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-left">
                        <div class="space-y-2">
                            <label class="text-sm font-medium ml-1">First Name</label>
                            <input type="text" name="fi-sender-firstName" required class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder:text-blue-200" placeholder="John">
                        </div>
                        <div class="space-y-2">
                            <label class="text-sm font-medium ml-1">Last Name</label>
                            <input type="text" name="fi-sender-lastName" required class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder:text-blue-200" placeholder="Citizen">
                        </div>
                        <div class="md:col-span-2 space-y-2">
                            <label class="text-sm font-medium ml-1">Email Address</label>
                            <input type="email" name="fi-sender-email" required class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder:text-blue-200" placeholder="john@example.com">
                        </div>
                        
                        <div class="md:col-span-2 space-y-2">
                            <label class="text-sm font-medium ml-1">Upload Blueprints (PDF, JPG, PNG)</label>
                            <input type="file" name="fi-file-blueprints" accept=".pdf,.jpg,.jpeg,.png" required class="w-full px-4 py-3 rounded-xl bg-white/5 border border-dashed border-white/30 text-white text-sm cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-white file:text-blue-600" />
                        </div>
                        <div class="md:col-span-2 space-y-2">
                            <label class="text-sm font-medium ml-1">Project Details</label>
                            <textarea name="fi-text-message" rows="4" class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder:text-blue-200" placeholder="e.g. 3-bedroom apartment in Sydney..."></textarea>
                        </div>

                        <div id="form-status" class="md:col-span-2 hidden p-4 rounded-xl font-bold text-center text-xs"></div>
                        
                        <button type="submit" id="submit-btn" class="md:col-span-2 mt-4 bg-white text-blue-600 py-4 rounded-xl font-bold text-lg hover:bg-blue-50 transition-all active:scale-95 shadow-lg">
                            Send Request
                        </button>
                    </form>
                </div>

                <div id="success-container" class="hidden py-12">
                    <div class="w-20 h-20 bg-white/20 text-white rounded-full flex items-center justify-center mx-auto mb-6 text-3xl">âœ“</div>
                    <h2 class="text-4xl font-bold mb-4">Request Received</h2>
                    <p class="text-blue-100 mb-10 text-lg">Thanks for reaching out. <br class="hidden md:block"> We will review your request and get back to you shortly.</p>
                    <button id="reset-btn" class="bg-white text-blue-600 px-8 py-3 rounded-xl font-bold hover:bg-blue-50 transition shadow-lg">Start a New Request</button>
                </div>
            </div>
        </section>
    </main>

    </Layout>

<script src="https://forminit.com/sdk/v1/forminit.js"></script>

<script is:inline>
	// Wait for the SDK and DOM to be fully ready
	window.addEventListener('load', () => {
	  if (typeof Forminit === 'undefined') {
		console.error("Forminit SDK failed to load. Check your CDN script tag.");
		return;
	  }
  
	  const forminit = new Forminit();
	  const FORM_ID = 'd0isg9sqemt'; //
	  
	  const form = document.getElementById('contact-form');
	  const btn = document.getElementById('submit-btn');
	  const status = document.getElementById('form-status');
	  const formContainer = document.getElementById('form-container');
	  const successContainer = document.getElementById('success-container');
  
	  form.addEventListener('submit', async function(event) {
		event.preventDefault(); // Stop the default "empty/refresh" behavior
		
		btn.disabled = true;
		btn.innerText = "Uploading Blueprints...";
		status.classList.add('hidden');
		
		const formData = new FormData(form); //
  
		try {
		  //
		  const { data, error } = await forminit.submit(FORM_ID, formData);
		  
		  if (error) {
			console.error("Forminit API Error:", error);
			status.textContent = error.message; //
			status.classList.remove('hidden');
			status.classList.add('bg-red-500/20', 'text-red-100');
			btn.disabled = false;
			btn.innerText = "Send Request";
			return;
		  }
		  
		  // Success: Swap UI first, THEN reset
		  console.log("Success! Submission Hash:", data.hashId); //
		  formContainer.classList.add('hidden');
		  successContainer.classList.remove('hidden');
		  form.reset(); 
  
		} catch (err) {
		  console.error("SDK Execution Error:", err);
		  status.textContent = "Connection failed. Please try again.";
		  status.classList.remove('hidden');
		  btn.disabled = false;
		  btn.innerText = "Send Request";
		}
	  });
	});
  </script>